// 农历转换工具
const LunarCalendar = {
    // 农历数字转中文
    DAY_NAMES: ["初一", "初二", "初三", "初四", "初五", "初六", "初七", "初八", "初九", "初十",
                "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十",
                "廿一", "廿二", "廿三", "廿四", "廿五", "廿六", "廿七", "廿八", "廿九", "三十"],

    // 节假日数据
    HOLIDAY_DICT: {
        "2025-01-01": "元旦",
        "2025-02-08": "小年",
        "2025-02-09": "除夕",
        "2025-02-10": "春节",
        "2025-02-14": "情人节",
        "2025-02-24": "元宵节",
        "2025-04-05": "清明节",
        "2025-05-01": "劳动节",
        "2025-06-22": "端午节",
        "2025-08-22": "七夕节",
        "2025-10-01": "国庆节",
        "2025-10-06": "中秋节",
        "2025-10-31": "万圣节",
        "2025-12-22": "冬至",
        "2025-12-25": "圣诞节",
        "2026-01-01": "元旦",
        "2026-01-28": "小年",
        "2026-01-29": "除夕",
        "2026-01-30": "春节",
        "2026-02-14": "情人节",
        "2026-02-13": "元宵节",
        "2026-04-05": "清明节",
        "2026-05-01": "劳动节",
        "2026-06-14": "端午节",
        "2026-08-11": "七夕节",
        "2026-09-10": "中秋节",
        "2026-10-01": "国庆节",
        "2026-10-31": "万圣节",
        "2026-12-21": "冬至",
        "2026-12-25": "圣诞节",
        "2027-01-01": "元旦",
        "2027-02-16": "小年",
        "2027-02-17": "除夕",
        "2027-02-18": "春节",
        "2027-02-14": "情人节",
        "2027-03-04": "元宵节",
        "2027-04-05": "清明节",
        "2027-05-01": "劳动节",
        "2027-06-05": "端午节",
        "2027-07-31": "七夕节",
        "2027-09-30": "中秋节",
        "2027-10-01": "国庆节",
        "2027-10-31": "万圣节",
        "2027-12-21": "冬至",
        "2027-12-25": "圣诞节",
        "2028-01-01": "元旦",
        "2028-02-04": "小年",
        "2028-02-05": "除夕",
        "2028-02-06": "春节",
        "2028-02-14": "情人节",
        "2028-02-22": "元宵节",
        "2028-04-05": "清明节",
        "2028-05-01": "劳动节",
        "2028-06-22": "端午节",
        "2028-08-19": "七夕节",
        "2028-09-18": "中秋节",
        "2028-10-01": "国庆节",
        "2028-10-31": "万圣节",
        "2028-12-21": "冬至",
        "2028-12-25": "圣诞节"
    },

    // 获取农历日期标签
    getLunarDate(date) {
        if (!(date instanceof Date) || Number.isNaN(date.getTime())) {
            return '';
        }

        try {
            if (window.solarlunar && typeof window.solarlunar.solar2lunar === 'function') {
                const lunar = window.solarlunar.solar2lunar(date.getFullYear(), date.getMonth() + 1, date.getDate());
                if (lunar) {
                    return lunar.dayCn === '初一' ? lunar.monthCn : lunar.dayCn;
                }
            }
        } catch (error) {
            console.warn('农历转换失败，使用回退方案。', error);
        }

        // 回退：简单映射日号
        const day = date.getDate();
        return this.DAY_NAMES[(day - 1) % this.DAY_NAMES.length];
    },

    // 获取节假日
    getHoliday(dateStr) {
        return this.HOLIDAY_DICT[dateStr] || '';
    }
};

window.LunarCalendar = LunarCalendar;